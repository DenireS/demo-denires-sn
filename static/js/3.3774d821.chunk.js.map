{"version":3,"sources":["components/Dialogs/Dialogs.module.css","components/Dialogs/DialogChat.module.css","components/Dialogs/DialogItem/DialogItem.jsx","components/Dialogs/Dialogs.jsx","hoc/withAuthRedirect.js","components/Dialogs/Message/Message.jsx","components/common/DateControls/DateControls.js","components/Dialogs/DialogChat.jsx","components/Dialogs/DialogsContainer.jsx"],"names":["module","exports","DialogItem","props","selectDialog","setCurrentChat","id","className","s","dialog","src","img","dialog__name","onClick","to","activeClassName","activeLink","name","Dialogs","dialogsElements","users","map","d","userName","key","photos","small","userPhoto","dialogs","dialogs__item","mapStateToPropsForRedirect","state","isAuth","auth","Message","time","slice","formattedTime","date","message","messageTitle","senderName","messageTime","messageBody","Textarea","FormType","maxLength10","maxLengthCreator","AddMessageFormRedux","reduxForm","form","onSubmit","handleSubmit","Field","component","validate","required","placeholder","DialogChat","messagesElements","messages","m","body","addedAt","chat","chatBottom","profile","messagesImg","values","sendMessage","currentChat","newMessageBody","DialogsContainer","this","userId","match","params","requestMessages","history","push","requestDialogs","refreshDialogs","prevProps","prevState","snapshot","isFetching","Preloader","React","PureComponent","compose","connect","dialogsPage","startChatting","Component","RedirectComponent","withRouter"],"mappings":"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","file":"static/js/3.3774d821.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"dialogs\":\"Dialogs_dialogs__1PoEC\",\"dialogs__item\":\"Dialogs_dialogs__item__3XPTy\",\"dialog\":\"Dialogs_dialog__31Tr1\",\"dialog__name\":\"Dialogs_dialog__name__kHnAw\",\"activeLink\":\"Dialogs_activeLink__3nhdI\",\"messages\":\"Dialogs_messages__2vLQu\",\"message\":\"Dialogs_message__AuSIq\",\"post\":\"Dialogs_post__1tN8A\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"chat\":\"DialogChat_chat__3jMcw\",\"messages\":\"DialogChat_messages__3TRMy\",\"message\":\"DialogChat_message__3xB4P\",\"show\":\"DialogChat_show__2av9d\",\"messageTitle\":\"DialogChat_messageTitle__1QHdv\",\"messageDate\":\"DialogChat_messageDate__Kaq8x\",\"messageTime\":\"DialogChat_messageTime__3Z7mY\",\"messagesImg\":\"DialogChat_messagesImg__oaMfm\"};","import React from 'react';\r\nimport s from '../Dialogs.module.css';\r\nimport {NavLink} from 'react-router-dom';\r\n\r\n\r\nfunction DialogItem(props) {\r\n    let selectDialog = () => {\r\n        props.setCurrentChat(props.id)\r\n    }\r\n\r\n    return (\r\n        <div className={s.dialog}>\r\n            <img src={props.img}></img>\r\n            <div className={s.dialog__name} onClick={() => selectDialog}>\r\n                <NavLink to={'/dialogs/' + props.id} activeClassName={s.activeLink}>\r\n                    {props.name}\r\n                </NavLink>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default DialogItem;\r\n","import React from 'react';\r\nimport s from './Dialogs.module.css';\r\nimport DialogItem from './DialogItem/DialogItem';\r\nimport userPhoto from '../../assets/images/User.jpg'\r\n\r\nlet Dialogs = (props) => {\r\n    let dialogsElements = props.users.map((d) => (\r\n        <DialogItem name={d.userName} key={d.id} id={d.id} img={d.photos.small || userPhoto } {...props}/>\r\n    ));\r\n    return (\r\n        <div className={s.dialogs}>\r\n            <div className={s.dialogs__item}>{dialogsElements}</div>\r\n        </div>\r\n    );\r\n}\r\n\r\n\r\nexport default Dialogs;\r\n","import React from 'react';\r\nimport { Redirect } from 'react-router-dom';\r\nimport { connect } from 'react-redux';\r\n\r\nlet mapStateToPropsForRedirect = (state) => ({\r\n  isAuth: state.auth.isAuth,\r\n});\r\n\r\nexport const withAuthRedirect = (Component) => {\r\n  class RedirectComponent extends React.Component {\r\n    render() {\r\n      if (!this.props.isAuth) return <Redirect to={'/login'} />;\r\n      return <Component {...this.props} />;\r\n    }\r\n  }\r\n  let ConnectedAuthRedirectComponent = connect(mapStateToPropsForRedirect)(\r\n    RedirectComponent\r\n  );\r\n  return ConnectedAuthRedirectComponent;\r\n};\r\n","import React from 'react';\r\nimport s from '../DialogChat.module.css';\r\nimport {formattedDate, formattedTime} from \"../../common/DateControls/DateControls\";\r\n\r\n\r\nfunction Message(props) {\r\n\r\n    // let date = formattedDate(props.date)\r\n    let time = formattedTime(props.date)\r\n\r\n    return (<>\r\n\r\n            <div className={s.message}>\r\n\r\n                <div className={s.messageTitle}>\r\n                    <div className={s.senderName}>{props.senderName}</div>\r\n                    <div className={s.messageTime}>{time}</div>\r\n                </div>\r\n\r\n                <div className={s.messageBody}>{props.message}</div>\r\n            </div>\r\n            {/*<div className={s.messageDate}>{date}</div>*/}\r\n\r\n        </>\r\n    );\r\n}\r\n\r\nexport default Message;\r\n","import React from \"react\";\r\n\r\nexport const formattedDate = (date) => {\r\n    let newDate = date.slice(0, 10)\r\n    return newDate\r\n\r\n}\r\nexport const formattedTime = (time) => {\r\n    let newTime = time.slice(11, 19)\r\n    return newTime\r\n\r\n}","import React from 'react';\r\nimport s from './DialogChat.module.css';\r\nimport Message from \"./Message/Message\";\r\nimport {FormType} from \"../../hoc/FormsControls\";\r\nimport {maxLengthCreator, required} from \"../../utils/validators/validators\";\r\nimport {Field, reduxForm} from \"redux-form\";\r\nimport userPhoto from '../../assets/images/User.jpg'\r\n\r\nfunction DialogChat(props) {\r\n    let messagesElements = props.messages.map((m) => (\r\n        <Message message={m.body} key={m.id} date={m.addedAt} senderName={m.senderName}/>\r\n    ));\r\n    let addNewMessage = (values) => {\r\n        props.sendMessage(props.currentChat, values.newMessageBody);\r\n        values.newMessageBody = null;\r\n    };\r\n\r\n    return (\r\n        <div>\r\n            <div className={s.chat}>\r\n                <div className={s.messages}>{messagesElements}</div>\r\n                <div className={s.chatBottom}>\r\n                    {props.profile &&\r\n                    <div><img className={s.messagesImg} src={props.profile.photos.small || userPhoto}/></div>}\r\n                    <AddMessageFormRedux onSubmit={addNewMessage}/>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nconst Textarea = FormType('textarea');\r\nconst maxLength10 = maxLengthCreator(10);\r\n\r\nconst AddMessageForm = (props) => {\r\n    return (\r\n        <form onSubmit={props.handleSubmit}>\r\n            <div>\r\n                <Field\r\n                    component={Textarea}\r\n                    validate={[required, maxLength10]}\r\n                    name=\"newMessageBody\"\r\n                    placeholder=\"Enter your message\"\r\n                />\r\n            </div>\r\n            <div>\r\n                <button>Add Message</button>\r\n            </div>\r\n        </form>\r\n    );\r\n};\r\n\r\nconst AddMessageFormRedux = reduxForm({\r\n    form: 'dialogAddMessageForm',\r\n})(AddMessageForm);\r\n\r\nexport default DialogChat;\r\n","import React from 'react';\r\nimport {\r\n    requestCurrentChatInfo,\r\n    requestDialogs,\r\n    requestMessages,\r\n    sendMessage,\r\n    setCurrentChat,\r\n    startChatting\r\n} from '../../redux/dialogs-reducer';\r\nimport Dialogs from './Dialogs';\r\nimport {connect} from 'react-redux';\r\nimport {Redirect, Route, withRouter} from 'react-router-dom';\r\nimport {withAuthRedirect} from '../../hoc/withAuthRedirect';\r\nimport {compose} from 'redux';\r\nimport Preloader from \"../common/Preloader/Preloader\";\r\nimport DialogChat from \"./DialogChat\";\r\n\r\n\r\nclass DialogsContainer extends React.PureComponent {\r\n\r\n    refreshDialogs() {\r\n        if (!this.props.isAuth) return <Redirect to={'/login'}/>;\r\n        let userId = this.props.match.params.userId;\r\n        if (!userId) {\r\n            this.props.history.push('/dialogs');\r\n            this.props.requestDialogs();\r\n        } else {\r\n            this.props.requestMessages(userId)\r\n            this.props.setCurrentChat(userId)\r\n        }\r\n\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.refreshDialogs()\r\n    }\r\n\r\n    componentDidUpdate(prevProps, prevState, snapshot) {\r\n        if (this.props.match.params.userId !== prevProps.match.params.userId) {\r\n            this.refreshDialogs();\r\n        }\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <>\r\n                {this.props.isFetching ? <Preloader/> : null}\r\n                {this.props.match.params.userId ? <DialogChat {...this.props} /> : <Dialogs {...this.props} />}\r\n            </>\r\n        )\r\n    }\r\n}\r\n\r\n\r\nlet mapStateToProps = (state) => {\r\n    return {\r\n        users: state.dialogsPage.users,\r\n        messages: state.dialogsPage.messages,\r\n        isFetching: state.dialogsPage.isFetching,\r\n        currentChat: state.dialogsPage.currentChat,\r\n        profile: state.dialogsPage.profile,\r\n    };\r\n};\r\n\r\n\r\nexport default compose(\r\n    connect(mapStateToProps, {sendMessage, requestDialogs, startChatting, setCurrentChat, requestMessages}),\r\n    withAuthRedirect,\r\n    withRouter\r\n)(DialogsContainer);\r\n"],"sourceRoot":""}